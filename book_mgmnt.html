<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Management (For Librarians)</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header with add button -->
    <div class="container">
        <div class="row align-items-center pt-3">
            <div class="col">
                <h1>Book Management</h1>
            </div>
            <div class="col-auto">
                <button type="button" class="btn btn-outline btn-lg me-2 px-5 py-4" data-toggle="modal" data-target="#formModal">Add</button>
            </div>
        </div>
    </div>

    <!-- form modal -->
    <div class="modal fade" id="formModal" tabindex="-1" aria-labelledby="formModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="formModalLabel">Form Modal</h5>
                </div>
                <div class="modal-body">
                    <form id="bookForm">
                        <div class="mb-3">
                            <label for="book-id" class="form-label">Book ID</label>
                            <input type="text" class="form-control" id="book-id" placeholder="Enter book ID">
                        </div>
                        <div class="mb-3">
                            <label for="title" class="form-label">Title</label>
                            <input type="text" class="form-control" id="title" placeholder="Enter title">
                        </div>
                        <div class="mb-3">
                            <label for="author" class="form-label">Author</label>
                            <input type="text" class="form-control" id="author" placeholder="Enter author">
                        </div>
                        <div class="mb-3">
                            <label for="genre" class="form-label">Genre</label>
                            <input type="text" class="form-control" id="genre" placeholder="Enter genre">
                        </div>
                        <div class="mb-3">
                            <label for="publisher" class="form-label">Publisher</label>
                            <input type="text" class="form-control" id="publisher" placeholder="Enter publisher">
                        </div>
                        <div class="mb-3">
                            <label for="publication-year" class="form-label">Publication Year</label>
                            <input type="text" class="form-control" id="publication-year" placeholder="Enter publication year">
                        </div>
                        <div class="mb-3">
                            <label for="availability" class="form-label">Availability</label>
                            <input type="text" class="form-control" id="availability" placeholder="Enter availability">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" onclick="addBook()">Add Book</button>
                    <button type="button" class="btn" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Table of books -->
    <div class="container mt-5">
        <table class="table table-hover text-center" id="bookTable">
            <thead>
                <tr>
                    <th scope="col">Book ID</th>
                    <th scope="col">Title</th>
                    <th scope="col">Author</th>
                    <th scope="col">Genre</th>
                    <th scope="col">Publisher</th>
                    <th scope="col">Publication Year</th>
                    <th scope="col">Availability</th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                <tr id="row1">
                    <td>1</td>
                    <td>What Is Computer Science?</td>
                    <td>LeBron James</td>
                    <td>Non-fiction</td>
                    <td>NBA</td>
                    <td>2024</td>
                    <td>Available</td>
                    <td>
                        <button type="button" class="btn btn-sm">Update</button>
                    </td>
                    <td>
                        <button type="button" class="btn btn-sm" onclick="deleteBook(`row1`)">Delete</button>
                    </td>
                </tr>
                <tr id="row2"></tr>
                    <td>2</td>
                    <td>All About Bugs</td>
                    <td>Dr. Seuss</td>
                    <td>Child Fiction</td>
                    <td>Penguin</td>
                    <td>1634</td>
                    <td>Checked Out</td>
                    <td>
                        <button type="button" class="btn btn-sm">Update</button>
                    </td>
                    <td>
                        <button type="button" class="btn btn-sm" onclick="deleteBook(`row2`)">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- adding a book -->
    <script>
        function addBook() {
            // get values
            const bookId = document.getElementById("book-id").value;
            const title = document.getElementById("title").value;
            const author = document.getElementById("author").value;
            const genre = document.getElementById("genre").value;
            const publisher = document.getElementById("publisher").value;
            const publicationYear = document.getElementById("publication-year").value;
            const availability = document.getElementById("availability").value;

            // check that all fields filled
            if (!bookId || !title || !author || !genre || !publisher || !publicationYear || !availability) {
                alert("Fill in all fields");
                return;
            }

            // create new row and cells
            const table = document.getElementById("bookTable").getElementsByTagName("tbody")[0];
            const newRow = table.insertRow();
            newRow.id = `row${table.rows.length}`;

            const cell1 = newRow.insertCell(0);
            const cell2 = newRow.insertCell(1);
            const cell3 = newRow.insertCell(2);
            const cell4 = newRow.insertCell(3);
            const cell5 = newRow.insertCell(4);
            const cell6 = newRow.insertCell(5);
            const cell7 = newRow.insertCell(6);

            // add button cells
            const updateCell = newRow.insertCell(7);
            const deleteCell = newRow.insertCell(8);

            // insert values
            cell1.innerHTML = bookId;
            cell2.innerHTML = title;
            cell3.innerHTML = author;
            cell4.innerHTML = genre;
            cell5.innerHTML = publisher;
            cell6.innerHTML = publicationYear;
            cell7.innerHTML = availability;

            // update button
            const updateButton = document.createElement("button");
            updateButton.type = "button";
            updateButton.className = "btn btn-sm";
            updateButton.innerText = "Update";
            updateButton.onclick = null;
            updateCell.appendChild(updateButton);

            // delete button
            const deleteButton = document.createElement("button");
            deleteButton.type = "button";
            deleteButton.className = "btn btn-sm";
            deleteButton.innerText = "Delete";
            deleteButton.onclick = function() {
                deleteBook(newRow.id);
            };
            deleteCell.appendChild(deleteButton);

            // clear form fields
            document.getElementById("bookForm").reset();

            // hide modal
            $('#formModal').modal('hide');
        }
    </script>

    <!-- deleting a book -->
    <script>
        function deleteBook(rowID) {
            console.log(rowID);
            const table = document.getElementById("bookTable").getElementsByTagName("tbody")[0];
            const row = document.getElementById(rowID);
            if (table.rows.length == 1) {
                alert("Only 1 row left, can't delete!");
            }
            else if (confirm("Are you sure you want to delete this entry?")) {
                row.remove();
            }
        }
    </script>
</body>
</html>